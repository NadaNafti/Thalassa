{% extends ":Front:base.html.twig" %}
{% block title %}{{ periode }}{% endblock %}
{% block body %}
    <div id="page_title">
        <div class="container clearfix">
            <div class="page-name">{{ block('title') }}</div>
            <div class="breadcrumb clearfix">
                <a href="{{ path('accueil') }}">Accueil</a>
                <a href="{{ path('front_voyageorganise_accueil') }}">Voyage Organisés</a>
                <a href="{{ path('front_voyageorganise_liste') }}">Liste</a>
                <a href="{{ path('front_voyageorganise_details',{'slug':app.request.get('slug')}) }}">{{ periode.voyage }}</a>
                <span class="current-page">{{ block('title') }}</span>
            </div>
        </div>
    </div>

    <div id="content_wrapper">
        <div class="container">
            <div class="row clearfix pv-50">
                <div class="col-xs-12 col-sm-8 col-md-8 xs-mb">
                    <div class="white-bg payment-wrapper">
                        {% include ':Front:alert.html.twig' %}
                        <div class="person-information" >
                            <h3 class="section-title">Information Personnelle <span class="step active">1</span></h3>
                            <hr>
                            {{ form_start(form) }}
                            <h4>Client :</h4>
                            <div style="display: none">
                                {{ formulaire.input("col-md-2","",form.client.responsable,false) }}
                            </div>
                            <div class="row">
                                {{ formulaire.input("col-md-4","Nom & prénom ",form.client.nomPrenom,true) }}
                                {{ formulaire.input("col-md-4","Tel 1",form.client.tel1,true) }}
                                {{ formulaire.input("col-md-4","Tel 2",form.client.tel2,true) }}
                            </div>
                            <div class="row">
                                {{ formulaire.input("col-md-12","Adresse",form.client.adresse,true) }}
                            </div>
                            <div style="display: none">
                                {{ formulaire.input("col-md-4","Matricule Fiscale",form.client.matriculeFiscale,true) }}
                                {{ formulaire.input("col-md-4","Registre Commercie",form.client.registreCommercie,true) }}
                                {{ formulaire.input("col-md-4","Commentaire",form.client.commentaire,true) }}
                            </div>
                            <h3 class="section-title">Pack Hôtels <span class="step active">2</span></h3>
                            <div class="row">
                                {{ formulaire.input("col-md-12",null,form.pack,true) }}
                            </div>			    
                            <div class="row" id="hotels"></div>		
                            <hr>
                            <div class="row">
                                <div class="col-md-8"></div>
                                <div class="col-md-4">
                                    <button class="btn btn-primary btn-block" type="submit">
                                        Occupation des chambres <i class="fa fa-arrow-circle-right"></i>
                                    </button>
                                </div>
                            </div>
                            {{ form_end(form) }}
                        </div>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" >
                    <div class="sidebar hotel-sidebar">
                        {% if not is_granted('IS_AUTHENTICATED_FULLY') %}
                            <div class="sidebar-item mb-20">
                                <div class="lp-box">
                                    <i class="text-info fa-lock"></i>
                                    <h4>Authentification</h4>
                                    <form action="{{ path("fos_user_security_check") }}" method="post">
                                        <input type="hidden" name="_csrf_token" value="{{ csrf_token }}" />
                                        <input type="hidden" name="_target_path" value="{{ app.request.uri() }}" />
                                        <div class="row">
                                            <div class="col-md-10">
                                                <div class="form-group">
                                                    <label for="first-name">Identifiant ou Email</label>
                                                    <input type="text" id="username" name="_username"  required="required" class="form-control" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-10">
                                                <div class="form-group">
                                                    <label for="first-name">Mots de passe</label>
                                                    <input type="password" id="password" name="_password"  required="required" class="form-control" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <button type="submit" class="btn btn-primary" id="_submit" name="_submit"  style="float: right;">S'authentifier</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        {% endif %}
                        <div class="sidebar-item mb-20">
                            <div class="summary-payment">
                                <div class="summary-header  mb-30">
                                    {% if periode.voyage.photoPrincipal is not null %}
                                        <img src="{{ asset(periode.voyage.photoPrincipal.assetPath) }}" alt="" style="width: 75px;height: 65px" />
                                    {% else %}
                                        <img src="https://placeholdit.imgix.net/~text?txtsize=10&txt=No%20image%20available&w=75&h=65" alt="" style="width: 75px;height: 65px" />
                                    {% endif %}
                                    <h3 class="no-mb">{{ periode.voyage|title }}</h3>
                                    <span>{{ periode.voyage.destination }}</span>
                                </div>
                                </div><div class="bb2 mb-30"></div>
				<table class="table table-bordered table-striped mb-30">
				    <tr>
					<td colspan=2><span class="text-bold">Période :</span> Du {{ periode.depart|date('d/m/Y') }} au {{ periode.retour|date('d/m/Y') }}</td>
				    </tr>
				</table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block jquery %}
    <script>
        $(document).ready(function () {
            $('#form_pack').on('change', function () {
                var val = $(this).val();
                $('#hotels').html("<div class='col-md-12'><p>Loading ...</p></div>");
                $.ajax({
                    url: '{{ path('front_voyageorganise_hotel_ajax') }}',
                    data: {'pack': val},
                    type: 'POST',
                    dataType: 'json',
                    success: function (json) {
                        $('#hotels').html('');
                        $.each(json, function (index, value) {
                            $('#hotels').append("<div class='col-md-12'><p> - <strong>"+value['libelle']+"</strong> ( "+value['categorie']+") </p></div>");
                        });
                    }
                });
            });
        })
    </script>
{% endblock %}